from math import pow,sqrt
import csv

def cosine_sim(vector1,vector2):
    # dot product
    dot_prod = 0
    for i in range(len(vector1)):
        dot_prod += vector1[i]*vector2[i]
    # vector magnitude
    mag_vector1 = 0
    mag_vector2 = 0
    for i in range(len(vector1)):
        mag_vector1 += pow(vector1[i],2)
    for i in range(len(vector2)):
        mag_vector2 += pow(vector2[i],2)
    mag_total = sqrt(mag_vector1)*sqrt(mag_vector2)
    # result
    
    return dot_prod/mag_total

# usage:
# vector1 = [25,98,30]
# vector2 = [20,90,10]
# print(cosine_sim(vector1,vector2))

output_tekstur = 'fitur/tekstur.csv'
output_warna = 'fitur/warna.csv'

def find(inputFeature, option):
    print(inputFeature[5]) # delete, bener
    results = {}
    if option == 'texture':
        with open(output_tekstur) as f:
            reader = csv.reader(f)

            for row in reader:
                datasetFeature = [float(x) for x in row[1:]]
                d = cosine_sim(inputFeature, datasetFeature)
                results[row[0]] = d

            f.close()
    elif option == 'color':
        print("ini masuk warna") # delete
        with open(output_warna) as f:
            reader = csv.reader(f)

            for row in reader:
                datasetFeature = [float(x) for x in row[1:]]
                print(inputFeature,end="") # delete
                print(inputFeature[5]) # delete
                d = cosine_sim(inputFeature, datasetFeature)
                results[row[0]] = d


            f.close()

    results = sorted([(v, k) for (k, v) in results.items()])
    # print(results) # delete

    return results
    # return results[:limit]

# usage ex:
# inputF = [126.14295651908023,0.1672657734818665,9.00105046776379,7.455525318003914,0.013465695481830138,0.9786704881314865]
# option = "texture"
# print("hasil:", find(inputF,option))

# usage ex:
# inputF = [0.0,0.0,0.0,0.0,0.0,6.0,0.0,0.0,0.0,0.0,0.0,0.0,4270.0,3008.0,0.0,0.0,0.0,0.0,0.0,0.0,3.0,155.0,0.0,0.0,0.0,0.0,0.0,0.0,2861.0,7359.0,0.0,0.0,0.0,0.0,0.0,0.0,5994.0,5872.0,0.0,0.0,0.0,0.0,0.0,0.0,7185.0,30.0,0.0,0.0,15.0,0.0,0.0,0.0,916.0,5063.0,17.0,20.0,0.0,0.0,0.0,0.0,408.0,5923.0,0.0,0.0,0.0,0.0,0.0,0.0,47.0,0.0,0.0,0.0,61.0,0.0,0.0,0.0,197.0,285.0,59.0,37.0,0.0,0.0,0.0,0.0,1000.0,1870.0,28.0,28.0,0.0,0.0,0.0,0.0,12.0,206.0,0.0,0.0,5.0,0.0,0.0,0.0,940.0,2117.0,2.0,2.0,0.0,0.0,0.0,0.0,17127.0,7635.0,0.0,0.0,0.0,0.0,0.0,0.0,2895.0,745.0,0.0,0.0,9.0,0.0,0.0,0.0,1510.0,4497.0,18.0,4.0,0.0,0.0,0.0,0.0,794.0,7012.0,0.0,0.0,0.0,0.0,0.0,0.0,57.0,0.0,0.0,0.0,35.0,0.0,0.0,0.0,261.0,437.0,39.0,45.0,0.0,0.0,0.0,0.0,1247.0,1217.0,25.0,22.0,0.0,0.0,0.0,0.0,19.0,203.0,0.0,0.0,1.0,0.0,0.0,0.0,230.0,1385.0,22.0,8.0,0.0,0.0,0.0,0.0,16114.0,9738.0,0.0,0.0,0.0,0.0,0.0,0.0,4987.0,1010.0,0.0,0.0,3.0,0.0,0.0,0.0,163.0,2970.0,28.0,10.0,0.0,0.0,0.0,0.0,20.0,8771.0,0.0,0.0,0.0,0.0,0.0,0.0,123.0,19.0,0.0,0.0,52.0,0.0,0.0,0.0,166.0,222.0,59.0,102.0,0.0,0.0,0.0,0.0,8758.0,1032.0,35.0,57.0,0.0,0.0,0.0,0.0,187.0,915.0,0.0,0.0,3.0,0.0,0.0,0.0,642.0,890.0,10.0,29.0,0.0,0.0,0.0,0.0,8376.0,11091.0,0.0,2.0,0.0,0.0,0.0,0.0,8032.0,199.0,0.0,0.0,0.0,0.0,0.0,0.0,224.0,1193.0,7.0,0.0,0.0,0.0,0.0,0.0,390.0,6469.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,10.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,58.0,0.0,0.0,0.0,0.0,0.0,0.0,8.0,432.0,0.0,0.0,0.0,0.0,0.0,0.0,1763.0,6320.0,0.0,0.0,0.0,0.0,0.0,0.0,4531.0,15790.0,0.0,0.0,0.0,0.0,0.0,0.0,6298.0,2369.0,0.0,0.0,0.0,0.0,0.0,0.0,1511.0,5241.0,0.0,0.0,0.0,0.0,0.0,0.0,192.0,4435.0,0.0,0.0,0.0,0.0,0.0,0.0,204.0,0.0,0.0,0.0,30.0,0.0,0.0,0.0,156.0,212.0,15.0,40.0,0.0,0.0,0.0,0.0,722.0,1739.0,16.0,12.0,0.0,0.0,0.0,0.0,331.0,1463.0,0.0,0.0,10.0,0.0,0.0,0.0,1025.0,4966.0,6.0,10.0,0.0,0.0,0.0,0.0,662.0,19053.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,3329.0,0.0,0.0,32.0,0.0,0.0,0.0,2607.0,8369.0,14.0,25.0,0.0,0.0,0.0,0.0,43.0,4264.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,63.0,0.0,0.0,0.0,428.0,332.0,107.0,78.0,0.0,0.0,0.0,0.0,1251.0,2115.0,127.0,80.0,0.0,0.0,0.0,0.0,190.0,928.0,0.0,0.0,16.0,0.0,0.0,0.0,1959.0,3276.0,87.0,6.0,0.0,0.0,0.0,0.0,918.0,21221.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,2415.0,0.0,0.0,9.0,0.0,0.0,0.0,1248.0,5128.0,11.0,0.0,0.0,0.0,0.0,0.0,9.0,7148.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,18.0,0.0,0.0,0.0,266.0,504.0,20.0,60.0,0.0,0.0,0.0,0.0,3554.0,599.0,1.0,10.0,0.0,0.0,0.0,0.0,218.0,114.0,1.0,0.0,16.0,0.0,0.0,0.0,2797.0,3151.0,22.0,28.0,0.0,0.0,0.0,0.0,5238.0,14245.0,0.0,0.0,0.0,0.0,0.0,0.0,3254.0,378.0,0.0,0.0,19.0,0.0,0.0,0.0,1368.0,4618.0,34.0,2.0,0.0,0.0,0.0,0.0,316.0,8300.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,5.0,0.0,1.0,0.0,0.0,0.0,0.0,54.0,438.0,1.0,0.0,0.0,0.0,0.0,0.0,146.0,1485.0,1.0,1.0,2.0,0.0,0.0,0.0,1415.0,2003.0,3.0,0.0,0.0,0.0,0.0,0.0,8561.0,19555.0,0.0,0.0,0.0,0.0,0.0,0.0,383.0,1651.0,0.0,0.0,2.0,0.0,0.0,0.0,2648.0,3131.0,7.0,0.0,0.0,0.0,0.0,0.0,1046.0,6611.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,34.0,0.0,0.0,0.0,111.0,156.0,7.0,34.0,0.0,0.0,0.0,0.0,411.0,1127.0,2.0,26.0,0.0,0.0,0.0,0.0,385.0,1023.0,1.0,1.0,45.0,0.0,0.0,0.0,2433.0,2360.0,30.0,20.0,0.0,0.0,0.0,0.0,5467.0,25768.0,0.0,0.0,0.0,0.0,0.0,0.0,112.0,1739.0,0.0,0.0,24.0,0.0,0.0,0.0,2304.0,2514.0,19.0,0.0,0.0,0.0,0.0,0.0,45.0,2954.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,268.0,0.0,0.0,0.0,987.0,815.0,331.0,238.0,0.0,0.0,0.0,0.0,1910.0,1959.0,207.0,143.0,0.0,0.0,0.0,0.0,1294.0,535.0,37.0,138.0,78.0,0.0,0.0,0.0,3678.0,7228.0,470.0,149.0,0.0,0.0,0.0,0.0,1278.0,17803.0,14.0,0.0,0.0,0.0,0.0,0.0,4.0,174.0,0.0,0.0,1.0,0.0,0.0,0.0,656.0,3778.0,3.0,0.0,0.0,0.0,0.0,0.0,72.0,4904.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,618.0,0.0,0.0,0.0,823.0,747.0,12.0,6.0,0.0,0.0,0.0,0.0,1839.0,476.0,7.0,1.0,0.0,0.0,0.0,0.0,1509.0,144.0,12.0,13.0,29.0,0.0,0.0,0.0,6575.0,4669.0,84.0,8.0,0.0,0.0,0.0,0.0,5550.0,13261.0,0.0,0.0,0.0,0.0,0.0,0.0,3468.0,259.0,0.0,0.0,3.0,0.0,0.0,0.0,1706.0,2703.0,4.0,1.0,0.0,0.0,0.0,0.0,794.0,3621.0,0.0,0.0,0.0,0.0,0.0,0.0,210.0,0.0,0.0,0.0,22.0,0.0,0.0,0.0,385.0,299.0,73.0,38.0,0.0,0.0,0.0,0.0,1014.0,1778.0,20.0,19.0,0.0,0.0,0.0,0.0,113.0,1865.0,0.0,0.0,58.0,0.0,0.0,0.0,2661.0,7249.0,13.0,65.0,0.0,0.0,0.0,0.0,6055.0,21548.0,0.0,1.0,0.0,0.0,0.0,0.0,2314.0,432.0,0.0,0.0,2.0,0.0,0.0,0.0,814.0,1508.0,71.0,8.0,0.0,0.0,0.0,0.0,11.0,716.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,28.0,0.0,0.0,0.0,142.0,382.0,10.0,15.0,0.0,0.0,0.0,0.0,1395.0,780.0,20.0,11.0,0.0,0.0,0.0,0.0,271.0,127.0,0.0,0.0,2.0,0.0,0.0,0.0,4118.0,6066.0,21.0,2.0,0.0,0.0,0.0,0.0,16694.0,5734.0,0.0,0.0,0.0,0.0,0.0,0.0,10478.0,162.0,0.0,0.0,4.0,0.0,0.0,0.0,1602.0,981.0,1.0,2.0,0.0,0.0,0.0,0.0,44.0,60.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,98.0,0.0,0.0,0.0,362.0,632.0,334.0,26.0,0.0,0.0,0.0,0.0,860.0,961.0,72.0,30.0,0.0,0.0,0.0,0.0,218.0,417.0,3.0,13.0,39.0,0.0,0.0,0.0,10775.0,3857.0,252.0,82.0,0.0,0.0,0.0,0.0,7311.0,3200.0,7.0,0.0,0.0,0.0,0.0,0.0,7163.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,9697.0,2614.0,9.0,0.0,0.0,0.0,0.0,0.0,26.0,93.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,89.0,0.0,0.0,0.0,448.0,381.0,12.0,20.0,0.0,0.0,0.0,0.0,505.0,550.0,1.0,5.0,0.0,0.0,0.0,0.0,1303.0,600.0,1.0,1.0,50.0,0.0,0.0,0.0,6854.0,3708.0,54.0,28.0,0.0,0.0,0.0,0.0,6411.0,6750.0,0.0,1.0,0.0,0.0,0.0,0.0,9855.0,606.0,0.0,0.0,0.0,0.0,0.0,0.0,4702.0,1637.0,0.0,0.0,0.0,0.0,0.0,0.0,230.0,4350.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]
# option = "color"
# print("hasil:", find(inputF,option))
