from math import pow,sqrt
import csv

def cosine_sim(vector1,vector2):
    # dot product
    dot_prod = 0
    for i in range(len(vector1)):
        dot_prod += vector1[i]*vector2[i]
    # vector magnitude
    mag_vector1 = 0
    mag_vector2 = 0
    for i in range(len(vector1)):
        mag_vector1 += pow(vector1[i],2)
    for i in range(len(vector2)):
        mag_vector2 += pow(vector2[i],2)
    mag_total = sqrt(mag_vector1)*sqrt(mag_vector2)
    # result
    
    return dot_prod/mag_total

# usage:
# vector1 = [25,98,30]
# vector2 = [20,90,10]
# print(cosine_sim(vector1,vector2))

output_tekstur = 'fitur/tekstur.csv'
output_warna = 'fitur/warna.csv'

def find(inputFeature, option):
    results = {}
    if option == 'texture':
        with open(output_tekstur) as f:
            reader = csv.reader(f)

            for row in reader:
                datasetFeature = [float(x) for x in row[1:]]
                d = cosine_sim(inputFeature, datasetFeature)
                results[row[0]] = d

            f.close()
    elif option == 'color':
        print("ini masuk warna") # delete
        with open(output_warna) as f:
            reader = csv.reader(f)

            for row in reader:
                datasetFeature = [float(x) for x in row[1:]]
                d = cosine_sim(inputFeature, datasetFeature)
                results[row[0]] = d

            f.close()

    results = sorted([(v, k) for (k, v) in results.items()])

    return results
    # return results[:limit]

# usage ex:
# inputF = [126.14295651908023,0.1672657734818665,9.00105046776379,7.455525318003914,0.013465695481830138,0.9786704881314865]
# option = "texture"
# print("hasil:", find(inputF,option))

# usage ex:
# inputF = [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2706.0,6492.0,0.0,0.0,0.0,0.0,0.0,0.0,1254.0,1877.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,15.0,0.0,0.0,0.0,892.0,2836.0,17.0,20.0,0.0,0.0,0.0,0.0,112.0,163.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,61.0,0.0,0.0,0.0,197.0,285.0,59.0,37.0,0.0,0.0,0.0,0.0,317.0,801.0,28.0,28.0,0.0,0.0,0.0,0.0,6.0,122.0,0.0,0.0,5.0,0.0,0.0,0.0,864.0,1090.0,2.0,2.0,0.0,0.0,0.0,0.0,579.0,5145.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,441.0,0.0,0.0,9.0,0.0,0.0,0.0,1494.0,2078.0,18.0,4.0,0.0,0.0,0.0,0.0,83.0,2629.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,35.0,0.0,0.0,0.0,261.0,437.0,39.0,45.0,0.0,0.0,0.0,0.0,540.0,1217.0,25.0,22.0,0.0,0.0,0.0,0.0,14.0,193.0,0.0,0.0,1.0,0.0,0.0,0.0,100.0,282.0,0.0,4.0,0.0,0.0,0.0,0.0,167.0,8044.0,0.0,0.0,0.0,0.0,0.0,0.0,3.0,584.0,0.0,0.0,3.0,0.0,0.0,0.0,129.0,394.0,27.0,10.0,0.0,0.0,0.0,0.0,14.0,3794.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,52.0,0.0,0.0,0.0,166.0,222.0,59.0,102.0,0.0,0.0,0.0,0.0,132.0,349.0,35.0,57.0,0.0,0.0,0.0,0.0,1.0,22.0,0.0,0.0,3.0,0.0,0.0,0.0,338.0,427.0,10.0,29.0,0.0,0.0,0.0,0.0,269.0,9000.0,0.0,2.0,0.0,0.0,0.0,0.0,0.0,7.0,0.0,0.0,0.0,0.0,0.0,0.0,184.0,320.0,7.0,0.0,0.0,0.0,0.0,0.0,8.0,4583.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1762.0,4707.0,0.0,0.0,0.0,0.0,0.0,0.0,3321.0,2415.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1511.0,2356.0,0.0,0.0,0.0,0.0,0.0,0.0,192.0,120.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,30.0,0.0,0.0,0.0,107.0,137.0,15.0,40.0,0.0,0.0,0.0,0.0,285.0,851.0,16.0,12.0,0.0,0.0,0.0,0.0,25.0,277.0,0.0,0.0,6.0,0.0,0.0,0.0,714.0,729.0,6.0,10.0,0.0,0.0,0.0,0.0,277.0,5417.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,536.0,0.0,0.0,32.0,0.0,0.0,0.0,2598.0,2555.0,14.0,25.0,0.0,0.0,0.0,0.0,43.0,1626.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,63.0,0.0,0.0,0.0,416.0,328.0,107.0,78.0,0.0,0.0,0.0,0.0,904.0,1518.0,127.0,80.0,0.0,0.0,0.0,0.0,26.0,143.0,0.0,0.0,16.0,0.0,0.0,0.0,1915.0,1116.0,87.0,6.0,0.0,0.0,0.0,0.0,686.0,5671.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,92.0,0.0,0.0,9.0,0.0,0.0,0.0,1248.0,983.0,11.0,0.0,0.0,0.0,0.0,0.0,8.0,744.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,17.0,0.0,0.0,0.0,245.0,491.0,18.0,57.0,0.0,0.0,0.0,0.0,193.0,307.0,0.0,8.0,0.0,0.0,0.0,0.0,4.0,35.0,0.0,0.0,14.0,0.0,0.0,0.0,2375.0,1286.0,19.0,21.0,0.0,0.0,0.0,0.0,500.0,7910.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,32.0,0.0,0.0,19.0,0.0,0.0,0.0,1356.0,1203.0,34.0,2.0,0.0,0.0,0.0,0.0,9.0,229.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,0.0,0.0,0.0,1383.0,1843.0,3.0,0.0,0.0,0.0,0.0,0.0,6112.0,1433.0,0.0,0.0,0.0,0.0,0.0,0.0,56.0,0.0,0.0,0.0,2.0,0.0,0.0,0.0,2648.0,1718.0,7.0,0.0,0.0,0.0,0.0,0.0,1034.0,143.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,17.0,0.0,0.0,0.0,26.0,21.0,3.0,11.0,0.0,0.0,0.0,0.0,16.0,99.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,9.0,0.0,0.0,41.0,0.0,0.0,0.0,1653.0,400.0,30.0,15.0,0.0,0.0,0.0,0.0,82.0,8238.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,66.0,0.0,0.0,24.0,0.0,0.0,0.0,2246.0,940.0,19.0,0.0,0.0,0.0,0.0,0.0,9.0,2419.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,164.0,0.0,0.0,0.0,493.0,534.0,191.0,144.0,0.0,0.0,0.0,0.0,575.0,1121.0,150.0,51.0,0.0,0.0,0.0,0.0,16.0,30.0,6.0,0.0,44.0,0.0,0.0,0.0,2066.0,2702.0,320.0,85.0,0.0,0.0,0.0,0.0,372.0,7226.0,14.0,0.0,0.0,0.0,0.0,0.0,0.0,31.0,0.0,0.0,1.0,0.0,0.0,0.0,20.0,25.0,3.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,614.0,0.0,0.0,0.0,795.0,729.0,10.0,4.0,0.0,0.0,0.0,0.0,218.0,197.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,0.0,0.0,28.0,0.0,0.0,0.0,6016.0,1851.0,83.0,0.0,0.0,0.0,0.0,0.0,266.0,4819.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,6.0,0.0,0.0,1.0,0.0,0.0,0.0,499.0,242.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,0.0,0.0,0.0,65.0,29.0,1.0,13.0,0.0,0.0,0.0,0.0,39.0,89.0,0.0,3.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,58.0,0.0,0.0,0.0,2614.0,7200.0,13.0,65.0,0.0,0.0,0.0,0.0,185.0,3669.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,0.0,0.0,0.0,799.0,1373.0,71.0,8.0,0.0,0.0,0.0,0.0,0.0,85.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,21.0,0.0,0.0,0.0,86.0,320.0,6.0,12.0,0.0,0.0,0.0,0.0,77.0,339.0,20.0,11.0,0.0,0.0,0.0,0.0,0.0,8.0,0.0,0.0,2.0,0.0,0.0,0.0,3284.0,5895.0,13.0,2.0,0.0,0.0,0.0,0.0,262.0,3908.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,4.0,0.0,0.0,0.0,1434.0,623.0,0.0,2.0,0.0,0.0,0.0,0.0,1.0,54.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,92.0,0.0,0.0,0.0,172.0,576.0,331.0,24.0,0.0,0.0,0.0,0.0,124.0,286.0,64.0,1.0,0.0,0.0,0.0,0.0,1.0,8.0,0.0,1.0,39.0,0.0,0.0,0.0,4013.0,2479.0,247.0,82.0,0.0,0.0,0.0,0.0,168.0,617.0,7.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,5260.0,1754.0,6.0,0.0,0.0,0.0,0.0,0.0,0.0,32.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,63.0,0.0,0.0,0.0,448.0,348.0,12.0,18.0,0.0,0.0,0.0,0.0,169.0,245.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,3.0,0.0,0.0,50.0,0.0,0.0,0.0,6302.0,2741.0,54.0,26.0,0.0,0.0,0.0,0.0,353.0,4503.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,990.0,59.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]
# option = "color"
# print("hasil:", find(inputF,option))
